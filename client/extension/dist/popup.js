import{c as v,j as t,r as n,B as p,T as r,C as i,a as l,b as w,d as C,e as B,R as T,f as A,g as I}from"./CardContent.js";const g=v(t.jsx("path",{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11z"}),"Security"),E=()=>{const[d,u]=n.useState([]),[a,h]=n.useState(!1),[m,x]=n.useState(null);n.useEffect(()=>{y()},[]);const y=async()=>{try{const e=await chrome.runtime.sendMessage({action:"getScanHistory"});u(e||[])}catch(e){console.error("Failed to load data:",e)}},S=async()=>{try{h(!0),x(null);const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!e.id||!e.url)throw new Error("No active tab found");if(!["chat.openai.com","claude.ai","bard.google.com"].some(c=>e.url.includes(c)))throw new Error("Current tab is not a supported AI platform");const f={platform:j(e.url),url:e.url,context:{messages:[],metadata:{url:e.url,timestamp:new Date().toISOString()}},timestamp:new Date().toISOString(),tests:["prompt-injection","jailbreaking","role-confusion","data-exfiltration"]},o=await chrome.runtime.sendMessage({action:"scanAgent",data:f});if(o.success){const c=o.data;u(b=>[c,...b])}else throw new Error(o.error||"Scan failed");await y()}catch(e){x(e.message)}finally{h(!1)}},j=e=>e.includes("chat.openai.com")?"ChatGPT":e.includes("claude.ai")?"Claude":e.includes("bard.google.com")?"Bard":"Unknown",s=d[0];return t.jsxs(p,{sx:{width:400,height:600,p:2},children:[t.jsxs(p,{sx:{textAlign:"center",mb:3},children:[t.jsx(g,{sx:{fontSize:48,color:"primary.main",mb:1}}),t.jsx(r,{variant:"h5",component:"h1",gutterBottom:!0,children:"AgentShield"}),t.jsx(r,{variant:"body2",color:"text.secondary",children:"AI Agent Security Scanner"})]}),m&&t.jsx(i,{sx:{mb:2,bgcolor:"error.light"},children:t.jsx(l,{children:t.jsx(r,{variant:"body2",color:"error.contrastText",children:m})})}),t.jsx(w,{variant:"contained",fullWidth:!0,startIcon:t.jsx(g,{}),onClick:S,disabled:a,sx:{mb:2},children:a?"Scanning...":"Scan Current Tab"}),s&&t.jsx(i,{children:t.jsxs(l,{children:[t.jsx(r,{variant:"h6",gutterBottom:!0,children:"Latest Scan Results"}),t.jsxs(r,{variant:"body2",color:"text.secondary",children:["Domain: ",s.domain]}),t.jsxs(r,{variant:"body2",color:"text.secondary",children:["Risk Score: ",s.results.score,"/100"]}),t.jsxs(r,{variant:"body2",color:"text.secondary",children:["Severity: ",s.results.severity]}),t.jsxs(r,{variant:"body2",color:"text.secondary",children:["Tests Passed: ",s.results.tests.filter(e=>e.passed).length,"/",s.results.tests.length]})]})}),d.length===0&&!a&&t.jsx(i,{children:t.jsxs(l,{sx:{textAlign:"center",py:4},children:[t.jsx(r,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No Scans Yet"}),t.jsx(r,{variant:"body2",color:"text.secondary",children:'Click "Scan Current Tab" to start scanning AI agents for security vulnerabilities.'})]})})]})},R=C({palette:{primary:{main:"#1976d2"},secondary:{main:"#dc004e"}},typography:{fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif'},components:{MuiButton:{styleOverrides:{root:{textTransform:"none"}}}}});B.createRoot(document.getElementById("root")).render(t.jsx(T.StrictMode,{children:t.jsxs(A,{theme:R,children:[t.jsx(I,{}),t.jsx(E,{})]})}));
